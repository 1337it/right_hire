<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    .print-format {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        color: #000;
        line-height: 1.4;
        max-width: 210mm;
        margin: 0 auto;
        background: white;
        padding: 15px;
    }

    /* Header Section */
    .gold-header {
        background: white; border: 3px solid #B8860B;
        padding: 15px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
    }

    .header-left {
        color: #000;
        flex: 1;
    }

    .company-name {
        font-size: 14px;
        font-weight: bold;
        margin-bottom: 3px;
        text-transform: uppercase;
    }

    .company-address {
        font-size: 9px;
        line-height: 1.3;
    }

    .header-logo {
        width: 150px;
        height: 90px;
        background: white;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 3px;
        font-weight: bold;
        font-size: 11px;
        color: #000;
    }

    /* Document Title */
    .document-title {
        text-align: center;
        font-size: 20px;
        font-weight: bold;
        margin: 20px 0 15px 0;
    }

    /* Agreement Header Row */
    .agreement-header {
        border: 2px solid #000;
        display: flex;
        margin-bottom: 2px;
    }

    .agreement-header-item {
        padding: 8px 12px;
        flex: 1;
        display: flex;
        justify-content: space-between;
        border-right: 2px solid #000;
    }

    .agreement-header-item:last-child {
        border-right: none;
    }

    .agreement-header-label {
        font-weight: bold;
        font-size: 12px;
    }

    .agreement-header-value {
        font-size: 12px;
    }

    /* Two Column Layout */
    .two-column-container {
        display: flex;
        gap: 2px;
        margin-bottom: 2px;
    }

    .left-column {
        flex: 1;
        border: 2px solid #000;
    }

    .right-column {
        flex: 1;
        border: 2px solid #000;
    }

    /* Section Boxes */
    .section-box {
        border: 2px solid #000;
        margin-bottom: 2px;
    }

    .section-header {
        background: white;
        padding: 6px 12px;
        font-weight: bold;
        font-size: 13px;
        text-transform: uppercase;
        border-bottom: 2px solid #000;
    }

    .section-content {
        padding: 10px 12px;
    }

    .info-row {
        display: flex;
        margin-bottom: 6px;
        font-size: 11px;
    }

    .info-label {
        font-weight: bold;
        min-width: 140px;
    }

    .info-value {
        flex: 1;
    }

    /* Financial Table */
    .financial-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 11px;
    }

    .financial-table td {
        padding: 5px 8px;
        text-align: left;
    }

    .financial-table .amount-col {
        text-align: right;
        font-weight: bold;
    }

    .total-row {
        font-weight: bold;
        font-size: 12px;
        border-top: 1px solid #000;
    }

    /* Payment Schedule Table */
    .schedule-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 10px;
        margin-top: 10px;
    }

    .schedule-table th {
        background: #f0f0f0;
        padding: 6px 8px;
        text-align: left;
        font-weight: bold;
        border: 1px solid #000;
    }

    .schedule-table td {
        padding: 5px 8px;
        border: 1px solid #000;
    }

    .schedule-table .amount-col {
        text-align: right;
    }

    /* Notice Text */
    .notice-section {
        margin: 15px 0;
        font-size: 9px;
        line-height: 1.5;
        text-align: justify;
    }

    .notice-section p {
        margin-bottom: 8px;
    }

    /* Signature Section */
    .signature-section {
        display: flex;
        justify-content: space-between;
        margin-top: 40px;
        padding-top: 60px;
    }

    .signature-box {
        text-align: center;
        width: 45%;
    }

    .signature-line {
        border-bottom: 2px solid #000;
        margin-bottom: 8px;
    }

    .signature-title {
        font-size: 11px;
        font-weight: bold;
        text-transform: uppercase;
    }

    /* Page Break */
    .page-break {
        page-break-before: always;
        break-before: page;
        display: block;
    }

    /* Terms Page */
    .terms-page {
        padding: 20px;
    }

    .terms-title {
        text-align: center;
        font-size: 22px;
        font-weight: bold;
        margin-bottom: 25px;
        text-transform: uppercase;
    }

    .terms-content {
        font-size: 11px;
        line-height: 1.6;
        text-align: justify;
    }

    .terms-content ol {
        padding-left: 20px;
    }

    .terms-content li {
        margin-bottom: 12px;
    }

    @media print {
        .page-break {
            page-break-before: always;
            break-before: page;
        }
        .page-break {
        page-break-before: always;
        break-before: page;
        display: block;
        }
        body {
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
    }
</style>

<div class="print-format">
    <!-- Gold Header -->
    <div class="gold-header">
        <div class="header-left">
            <div class="company-name">{{ frappe.db.get_default("company") or "RIGHT HIRE" }}</div>
            <div class="company-address">
                {% set company_doc = frappe.get_doc("Company", frappe.db.get_default("company")) if frappe.db.get_default("company") else None %}
                {% if company_doc %}
                {{ company_doc.address or "" }}<br>
                {{ company_doc.city or "" }} {{ company_doc.country or "" }}<br>
                Office: {{ company_doc.phone or "+971 4 XXXXXXX" }}
                {% else %}
                Address Line 1<br>
                Dubai, UAE<br>
                Office: +971 4 XXXXXXX
                {% endif %}
            </div>
        </div>
        <div class="header-logo">
            <img src="/files/logo.png" style="max-width: 100%; max-height: 90px;" alt="Company Logo">
        </div>
    </div>

    <!-- Document Title -->
    <div class="document-title">Lease Contract</div>

    <!-- Agreement Number and Date -->
    <div class="agreement-header">
        <div class="agreement-header-item">
            <span class="agreement-header-label">Contract Number:</span>
            <span class="agreement-header-value">{{ doc.name }}</span>
        </div>
        <div class="agreement-header-item">
            <span class="agreement-header-label">Contract Date:</span>
            <span class="agreement-header-value">{{ frappe.utils.formatdate(doc.contract_date, "dd-MMM-yy") if doc.contract_date else "" }}</span>
        </div>
    </div>

    <!-- Two Column Layout: LESSOR and LEASED VEHICLE -->
    <div class="two-column-container">
        <!-- Left: LESSOR -->
        <div class="left-column">
            <div class="section-header">LESSOR</div>
            <div class="section-content">
                <div class="info-row">
                    <div class="info-label">Company</div>
                    <div class="info-value">{{ frappe.db.get_default("company") or "RIGHT HIRE" }}</div>
                </div>
                {% if doc.branch %}
                <div class="info-row">
                    <div class="info-label">Branch:</div>
                    <div class="info-value">{{ doc.branch }}</div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Right: LEASED VEHICLE -->
        <div class="right-column">
            <div class="section-header">LEASED VEHICLE</div>
            <div class="section-content">
                <div class="info-row">
                    <div class="info-label">Type:</div>
                    <div class="info-value">{{ doc.vehicle or "" }}</div>
                </div>
                {% if doc.plate_no %}
                <div class="info-row">
                    <div class="info-label">Plate No:</div>
                    <div class="info-value">{{ doc.plate_no }}</div>
                </div>
                {% endif %}
                {% if doc.vehicle_category %}
                <div class="info-row">
                    <div class="info-label">Category:</div>
                    <div class="info-value">{{ doc.vehicle_category }}</div>
                </div>
                {% endif %}
                {% if doc.parking_lot %}
                <div class="info-row">
                    <div class="info-label">Parking Lot:</div>
                    <div class="info-value">{{ doc.parking_lot }}</div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Two Column Layout: LESSEE and LEASE PERIOD -->
    <div class="two-column-container">
        <!-- Left: LESSEE -->
        <div class="left-column">
            <div class="section-header">LESSEE</div>
            <div class="section-content">
                <div class="info-row">
                    <div class="info-label">Name:</div>
                    <div class="info-value">{{ doc.customer_name or doc.customer }}</div>
                </div>
                {% if doc.customer_code %}
                <div class="info-row">
                    <div class="info-label">Customer code:</div>
                    <div class="info-value">{{ doc.customer_code }}</div>
                </div>
                {% endif %}
                {% if doc.customer_address %}
                <div class="info-row">
                    <div class="info-label">Address</div>
                    <div class="info-value">{{ doc.customer_address }}</div>
                </div>
                {% endif %}
                {% if doc.contact_mobile %}
                <div class="info-row">
                    <div class="info-label">Mobile No</div>
                    <div class="info-value">{{ doc.contact_mobile }}</div>
                </div>
                {% endif %}
                {% if doc.contact_email %}
                <div class="info-row">
                    <div class="info-label">Email</div>
                    <div class="info-value">{{ doc.contact_email }}</div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Right: LEASE PERIOD -->
        <div class="right-column">
            <div class="section-header">LEASE PERIOD</div>
            <div class="section-content">
                <div class="info-row">
                    <div class="info-label">Start Date</div>
                    <div class="info-value">{{ frappe.utils.formatdate(doc.start_date, "dd-MMM-yy") if doc.start_date else "" }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">End Date</div>
                    <div class="info-value">{{ frappe.utils.formatdate(doc.end_date, "dd-MMM-yy") if doc.end_date else "" }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Duration</div>
                    <div class="info-value">{{ doc.tenure_months or 0 }} Months</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Billing Cycle</div>
                    <div class="info-value">{{ doc.billing_cycle or "Monthly" }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Two Column Layout: VEHICLE DETAILS and LEASE TERMS -->
    <div class="two-column-container">
        <!-- Left: VEHICLE DETAILS -->
        <div class="left-column">
            <div class="section-header">Vehicle Details</div>
            <div class="section-content">
                {% if doc.odometer_value %}
                <div class="info-row">
                    <div class="info-label">Odometer:</div>
                    <div class="info-value">{{ "{:,.0f}".format(doc.odometer_value) }} Km</div>
                </div>
                {% endif %}
                {% if doc.registration_expiry %}
                <div class="info-row">
                    <div class="info-label">Registration Expiry:</div>
                    <div class="info-value">{{ frappe.utils.formatdate(doc.registration_expiry, "dd-MMM-yy") }}</div>
                </div>
                {% endif %}
                {% if doc.insurance_expiry %}
                <div class="info-row">
                    <div class="info-label">Insurance Expiry:</div>
                    <div class="info-value">{{ frappe.utils.formatdate(doc.insurance_expiry, "dd-MMM-yy") }}</div>
                </div>
                {% endif %}
                {% if doc.last_service_date %}
                <div class="info-row">
                    <div class="info-label">Last Service:</div>
                    <div class="info-value">{{ frappe.utils.formatdate(doc.last_service_date, "dd-MMM-yy") }}</div>
                </div>
                {% endif %}
            </div>
            <div class="section-header" style="border-top: none;">Detail</div>
            <div class="section-content">
                <div class="info-row">
                    <div class="info-label">Notes:</div>
                    <div class="info-value">{{ doc.notes or "" }}</div>
                </div>
                {% if doc.special_terms %}
                <div class="info-row">
                    <div class="info-label">Special Terms:</div>
                    <div class="info-value">{{ doc.special_terms[:100] }}...</div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Right: LEASE TERMS & CHARGES -->
        <div class="right-column">
            <div class="section-header">LEASE TERMS & CHARGES</div>
            <div class="section-content">
                <table class="financial-table">
                    <tbody>
                        <tr>
                            <td>Monthly Lease Rate</td>
                            <td>{{ doc.tenure_months or 0 }} x {{ "{:,.2f}".format(doc.monthly_rate or 0) }} /Month</td>
                            <td class="amount-col">{{ "{:,.2f}".format((doc.monthly_rate or 0) * (doc.tenure_months or 0)) }}</td>
                        </tr>
                        {% if doc.security_deposit %}
                        <tr>
                            <td>Security Deposit</td>
                            <td></td>
                            <td class="amount-col">{{ "{:,.2f}".format(doc.security_deposit) }}</td>
                        </tr>
                        {% endif %}
                        {% if doc.advance_payment %}
                        <tr>
                            <td>Advance Payment</td>
                            <td>{{ doc.advance_months or 0 }} Month(s)</td>
                            <td class="amount-col">{{ "{:,.2f}".format(doc.advance_payment) }}</td>
                        </tr>
                        {% endif %}
                        <tr>
                            <td>Maintenance</td>
                            <td></td>
                            <td class="amount-col">{{ "Included" if doc.maintenance_included else "Not Included" }}</td>
                        </tr>
                        <tr>
                            <td>Insurance</td>
                            <td></td>
                            <td class="amount-col">{{ "Included" if doc.insurance_included else "Not Included" }}</td>
                        </tr>
                        <tr>
                            <td>KM Allowance (Monthly)</td>
                            <td></td>
                            <td class="amount-col">{{ "{:,.0f}".format(doc.km_allowance_monthly or 0) }}</td>
                        </tr>
                        {% if doc.overage_per_km %}
                        <tr>
                            <td>Excess KM Charge</td>
                            <td></td>
                            <td class="amount-col">{{ "{:,.2f}".format(doc.overage_per_km) }}/KM</td>
                        </tr>
                        {% endif %}
                        <tr class="total-row">
                            <td colspan="2">Total Contract Value:</td>
                            <td class="amount-col">AED {{ "{:,.2f}".format((doc.monthly_rate or 0) * (doc.tenure_months or 0)) }}</td>
                        </tr>
                        {% if doc.total_invoiced %}
                        <tr>
                            <td colspan="2">Total Invoiced</td>
                            <td class="amount-col">AED {{ "{:,.2f}".format(doc.total_invoiced) }}</td>
                        </tr>
                        {% endif %}
                        {% if doc.total_outstanding %}
                        <tr>
                            <td colspan="2">Outstanding</td>
                            <td class="amount-col">AED {{ "{:,.2f}".format(doc.total_outstanding) }}</td>
                        </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Payment Schedule -->
    {% if doc.invoice_schedule %}
    <div class="section-box">
        <div class="section-header">Payment Schedule</div>
        <div class="section-content">
            <table class="schedule-table">
                <thead>
                    <tr>
                        <th style="width: 30px;">#</th>
                        <th>Invoice Date</th>
                        <th>Due Date</th>
                        <th style="text-align: right;">Amount (AED)</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for schedule in doc.invoice_schedule[:10] %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ frappe.utils.formatdate(schedule.invoice_date, "dd-MMM-yy") }}</td>
                        <td>{{ frappe.utils.formatdate(schedule.due_date, "dd-MMM-yy") }}</td>
                        <td class="amount-col">{{ "{:,.2f}".format(schedule.amount or 0) }}</td>
                        <td>{{ schedule.status or "Pending" }}</td>
                    </tr>
                    {% endfor %}
                    {% if doc.invoice_schedule|length > 10 %}
                    <tr>
                        <td colspan="5" style="text-align: center; font-style: italic; font-size: 9px;">... and {{ doc.invoice_schedule|length - 10 }} more payments</td>
                    </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}

    <!-- Notice Section -->
    <div class="notice-section">
        <p><strong>Notice:</strong> This lease contract is subject to the terms and conditions outlined herein. The lessee agrees to maintain the vehicle in good condition and return it at the end of the lease period in satisfactory condition, normal wear and tear excepted.</p>

        <p>All payments must be made according to the payment schedule outlined above. Late payments may incur additional charges and may affect the lessee's standing with {{ frappe.db.get_default("company") or "RIGHT HIRE" }}.</p>

        <p>The security deposit will be refunded within 30 days after the end of the lease period, subject to vehicle inspection and settlement of all outstanding charges including traffic fines, damages, and excess kilometrage.</p>

        <p>{{ frappe.db.get_default("company") or "RIGHT HIRE" }} reserves the right to inspect the vehicle at any time during the lease period to ensure compliance with maintenance requirements and proper usage.</p>

        <p>Any modifications to this lease contract must be made in writing and signed by both parties. This contract supersedes all prior agreements and understandings between the parties.</p>

        <p>This is a legal and binding contract between the Lessor and the Lessee; who agree to the standard Terms and Conditions printed on the following page of this contract.</p>
    </div>

    <!-- Signature Section -->
    <div class="signature-section">
        <div class="signature-box">
            <div class="signature-line"></div>
            <div class="signature-title">LESSEE OR<br>AUTHORIZED AGENT</div>
        </div>
        <div class="signature-box">
            <div class="signature-line"></div>
            <div class="signature-title">LESSOR OR<br>AUTHORIZED AGENT</div>
        </div>
    </div>

    <!-- TERMS & CONDITIONS - NEW PAGE -->
    <div class="page-break">
        <div class="terms-page">
            <div class="terms-title">Terms and Conditions - Lease Contract</div>

            {% if doc.terms_and_conditions %}
            <div class="terms-content">
                {{ doc.terms_and_conditions }}
            </div>
            {% else %}
            <div class="terms-content">
                <ol>
                    <li><strong>Vehicle Use and Care:</strong> The Lessee agrees to use the leased vehicle in a proper, careful, and lawful manner. The vehicle shall be operated in accordance with all applicable traffic laws and regulations. The Lessee shall maintain the vehicle in good condition and shall not make any modifications without prior written consent from the Lessor.</li>

                    <li><strong>Maintenance and Servicing:</strong> The Lessee is responsible for regular maintenance and servicing of the vehicle according to the manufacturer's recommended schedule. All maintenance records must be kept and provided to the Lessor upon request. Major repairs and replacements shall be coordinated with and approved by the Lessor.</li>

                    <li><strong>Insurance Coverage:</strong> The vehicle is covered under a comprehensive insurance policy. The Lessee must comply with all insurance policy requirements. In case of an accident, the Lessee must immediately notify both the Lessor and the police, and obtain a police report. The Lessee may be responsible for insurance deductibles as specified in this contract.</li>

                    <li><strong>Payment Terms:</strong> Monthly lease payments are due on the billing day specified in this contract. Payments received after the due date may be subject to late payment penalties. The Lessee agrees to maintain a valid payment method and ensure sufficient funds for automatic payments if applicable.</li>

                    <li><strong>Security Deposit:</strong> The security deposit shall be held by the Lessor for the duration of the lease period. Upon satisfactory return of the vehicle and settlement of all obligations, the deposit will be refunded within 30 days. The Lessor may deduct from the deposit any amounts owed for damages, excess kilometrage, traffic violations, or other charges.</li>

                    <li><strong>Kilometrage Allowance:</strong> The lease includes a monthly kilometrage allowance as specified in this contract. Excess kilometrage will be charged at the rate specified herein. Kilometrage shall be calculated based on the vehicle's odometer readings at regular intervals as determined by the Lessor.</li>

                    <li><strong>Traffic Violations and Fines:</strong> The Lessee is solely responsible for all traffic violations, fines, and penalties incurred during the lease period. The Lessee must settle all such violations promptly. The Lessor reserves the right to charge the Lessee for any fines plus an administrative fee for processing.</li>

                    <li><strong>Registration and Documentation:</strong> The Lessor shall maintain the vehicle's registration and ensure all required documentation is current. The Lessee must keep the vehicle's registration card and insurance documents in the vehicle at all times and produce them upon request by authorities.</li>

                    <li><strong>Prohibited Uses:</strong> The Lessee shall not: (a) use the vehicle for any illegal purpose; (b) operate the vehicle while under the influence of alcohol or drugs; (c) allow unauthorized persons to drive the vehicle; (d) use the vehicle for racing, testing, or any competitive activities; (e) take the vehicle outside the UAE without prior written permission; (f) sublet or allow any lien to be placed on the vehicle.</li>

                    <li><strong>Early Termination:</strong> Either party may terminate this lease agreement by providing written notice as specified in this contract. Early termination by the Lessee may be subject to penalties including payment of a termination fee and/or remaining lease payments for a minimum commitment period. The vehicle must be returned in good condition upon termination.</li>

                    <li><strong>Vehicle Return:</strong> At the end of the lease period, the Lessee must return the vehicle in good condition, normal wear and tear excepted. The Lessor will conduct a thorough inspection and assess any damages beyond normal wear. The Lessee will be charged for any repairs, cleaning, or reconditioning required to restore the vehicle to acceptable condition.</li>

                    <li><strong>Force Majeure:</strong> Neither party shall be liable for any delay or failure to perform obligations under this contract due to circumstances beyond their reasonable control, including but not limited to acts of God, war, strikes, or government actions. However, the Lessee remains responsible for the vehicle's security and safekeeping.</li>

                    <li><strong>Dispute Resolution:</strong> Any disputes arising from this lease contract shall first be attempted to be resolved through good faith negotiations between the parties. If resolution cannot be achieved, the matter shall be submitted to arbitration or legal proceedings in accordance with the laws of the United Arab Emirates.</li>

                    <li><strong>Governing Law and Jurisdiction:</strong> This lease contract is governed by the laws of the United Arab Emirates. Both parties agree to submit to the exclusive jurisdiction of the courts of Dubai, UAE for any legal proceedings arising from this contract.</li>

                    <li><strong>Entire Agreement:</strong> This document constitutes the entire lease agreement between the Lessor and Lessee and supersedes all prior agreements, understandings, or representations. Any amendments or modifications to this contract must be made in writing and signed by both parties to be valid and enforceable.</li>
                </ol>
            </div>
            {% endif %}

            <!-- Signature Section on Terms Page -->
            <div class="signature-section">
                <div class="signature-box">
                    <div class="signature-line"></div>
                    <div class="signature-title">LESSEE OR<br>AUTHORIZED AGENT</div>
                </div>
                <div class="signature-box">
                    <div class="signature-line"></div>
                    <div class="signature-title">LESSOR OR<br>AUTHORIZED AGENT</div>
                </div>
            </div>
        </div>
    </div>
</div>
