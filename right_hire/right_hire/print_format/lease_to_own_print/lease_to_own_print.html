<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    .print-format {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        color: #000;
        line-height: 1.4;
        max-width: 210mm;
        margin: 0 auto;
        background: white;
        padding: 15px;
    }

    /* Header Section */
    .gold-header {
        background: white; border: 3px solid #B8860B;
        padding: 15px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
    }

    .header-left {
        color: #000;
        flex: 1;
    }

    .company-name {
        font-size: 14px;
        font-weight: bold;
        margin-bottom: 3px;
        text-transform: uppercase;
    }

    .company-address {
        font-size: 9px;
        line-height: 1.3;
    }

    .header-logo {
        width: 150px;
        height: 90px;
        background: white;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 3px;
        font-weight: bold;
        font-size: 11px;
        color: #000;
    }

    /* Document Title */
    .document-title {
        text-align: center;
        font-size: 20px;
        font-weight: bold;
        margin: 20px 0 15px 0;
    }

    /* Agreement Header Row */
    .agreement-header {
        border: 2px solid #000;
        display: flex;
        margin-bottom: 2px;
    }

    .agreement-header-item {
        padding: 8px 12px;
        flex: 1;
        display: flex;
        justify-content: space-between;
        border-right: 2px solid #000;
    }

    .agreement-header-item:last-child {
        border-right: none;
    }

    .agreement-header-label {
        font-weight: bold;
        font-size: 12px;
    }

    .agreement-header-value {
        font-size: 12px;
    }

    /* Two Column Layout */
    .two-column-container {
        display: flex;
        gap: 2px;
        margin-bottom: 2px;
    }

    .left-column {
        flex: 1;
        border: 2px solid #000;
    }

    .right-column {
        flex: 1;
        border: 2px solid #000;
    }

    /* Section Boxes */
    .section-box {
        border: 2px solid #000;
        margin-bottom: 2px;
    }

    .section-header {
        background: white;
        padding: 6px 12px;
        font-weight: bold;
        font-size: 13px;
        text-transform: uppercase;
        border-bottom: 2px solid #000;
    }

    .section-content {
        padding: 10px 12px;
    }

    .info-row {
        display: flex;
        margin-bottom: 6px;
        font-size: 11px;
    }

    .info-label {
        font-weight: bold;
        min-width: 160px;
    }

    .info-value {
        flex: 1;
    }

    /* Financial Table */
    .financial-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 11px;
    }

    .financial-table td {
        padding: 5px 8px;
        text-align: left;
    }

    .financial-table .amount-col {
        text-align: right;
        font-weight: bold;
    }

    .total-row {
        font-weight: bold;
        font-size: 12px;
        border-top: 1px solid #000;
    }

    /* Progress Section */
    .progress-section {
        border: 2px solid #000;
        margin-bottom: 2px;
        background: #f9f9f9;
    }

    .progress-bar-container {
        background: #e0e0e0;
        height: 25px;
        border-radius: 3px;
        overflow: hidden;
        margin: 10px 0;
        position: relative;
    }

    .progress-bar-fill {
        background: white; border: 3px solid #B8860B;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: flex-end;
        padding-right: 10px;
        color: #000;
        font-weight: bold;
        font-size: 11px;
    }

    .progress-stats {
        display: flex;
        justify-content: space-around;
        margin-top: 10px;
        padding-top: 10px;
        border-top: 1px solid #000;
    }

    .progress-stat {
        text-align: center;
        font-size: 10px;
    }

    .progress-stat-value {
        font-weight: bold;
        font-size: 12px;
        margin-top: 3px;
    }

    /* Notice Text */
    .notice-section {
        margin: 15px 0;
        font-size: 9px;
        line-height: 1.5;
        text-align: justify;
    }

    .notice-section p {
        margin-bottom: 8px;
    }

    /* Signature Section */
    .signature-section {
        display: flex;
        justify-content: space-between;
        margin-top: 40px;
        padding-top: 60px;
    }

    .signature-box {
        text-align: center;
        width: 45%;
    }

    .signature-line {
        border-bottom: 2px solid #000;
        margin-bottom: 8px;
    }

    .signature-title {
        font-size: 11px;
        font-weight: bold;
        text-transform: uppercase;
    }

    /* Page Break */
    .page-break {
        page-break-before: always;
        break-before: page;
        display: block;
    }

    /* Terms Page */
    .terms-page {
        padding: 20px;
    }

    .terms-title {
        text-align: center;
        font-size: 22px;
        font-weight: bold;
        margin-bottom: 25px;
        text-transform: uppercase;
    }

    .terms-content {
        font-size: 11px;
        line-height: 1.6;
        text-align: justify;
    }

    .terms-content ol {
        padding-left: 20px;
    }

    .terms-content li {
        margin-bottom: 12px;
    }

    @media print {
        .page-break {
            page-break-before: always;
            break-before: page;
        }
        .page-break {
        page-break-before: always;
        break-before: page;
        display: block;
        }
        body {
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
    }
</style>

<div class="print-format">
    <!-- Gold Header -->
    <div class="gold-header">
        <div class="header-left">
            <div class="company-name">{{ frappe.db.get_default("company") or "RIGHT HIRE" }}</div>
            <div class="company-address">
                {% set company_doc = frappe.get_doc("Company", frappe.db.get_default("company")) if frappe.db.get_default("company") else None %}
                {% if company_doc %}
                {{ company_doc.address or "" }}<br>
                {{ company_doc.city or "" }} {{ company_doc.country or "" }}<br>
                Office: {{ company_doc.phone or "+971 4 XXXXXXX" }}
                {% else %}
                Address Line 1<br>
                Dubai, UAE<br>
                Office: +971 4 XXXXXXX
                {% endif %}
            </div>
        </div>
        <div class="header-logo">
            <img src="/files/logo.png" style="max-width: 100%; max-height: 90px;" alt="Company Logo">
        </div>
    </div>

    <!-- Document Title -->
    <div class="document-title">Lease to Own Agreement</div>

    <!-- Agreement Number and Date -->
    <div class="agreement-header">
        <div class="agreement-header-item">
            <span class="agreement-header-label">Contract Number:</span>
            <span class="agreement-header-value">{{ doc.name }}</span>
        </div>
        <div class="agreement-header-item">
            <span class="agreement-header-label">Contract Date:</span>
            <span class="agreement-header-value">{{ frappe.utils.formatdate(doc.contract_date if doc.contract_date else doc.creation, "dd-MMM-yy") }}</span>
        </div>
    </div>

    <!-- Two Column Layout: SELLER and VEHICLE -->
    <div class="two-column-container">
        <!-- Left: SELLER -->
        <div class="left-column">
            <div class="section-header">SELLER (Current Owner)</div>
            <div class="section-content">
                <div class="info-row">
                    <div class="info-label">Company</div>
                    <div class="info-value">{{ frappe.db.get_default("company") or "RIGHT HIRE" }}</div>
                </div>
            </div>
        </div>

        <!-- Right: VEHICLE -->
        <div class="right-column">
            <div class="section-header">VEHICLE</div>
            <div class="section-content">
                <div class="info-row">
                    <div class="info-label">Type:</div>
                    <div class="info-value">{{ doc.vehicle or "" }}</div>
                </div>
                {% if doc.plate_no %}
                <div class="info-row">
                    <div class="info-label">Plate No:</div>
                    <div class="info-value">{{ doc.plate_no }}</div>
                </div>
                {% endif %}
                {% if doc.vehicle_details %}
                <div class="info-row">
                    <div class="info-label">Details:</div>
                    <div class="info-value">{{ doc.vehicle_details }}</div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Two Column Layout: BUYER and CONTRACT PERIOD -->
    <div class="two-column-container">
        <!-- Left: BUYER -->
        <div class="left-column">
            <div class="section-header">BUYER (Future Owner)</div>
            <div class="section-content">
                <div class="info-row">
                    <div class="info-label">Name:</div>
                    <div class="info-value">{{ doc.customer_name or doc.customer }}</div>
                </div>
                {% if doc.customer_code %}
                <div class="info-row">
                    <div class="info-label">Customer code:</div>
                    <div class="info-value">{{ doc.customer_code }}</div>
                </div>
                {% endif %}
                {% if doc.contact_number %}
                <div class="info-row">
                    <div class="info-label">Mobile No</div>
                    <div class="info-value">{{ doc.contact_number }}</div>
                </div>
                {% endif %}
                {% if doc.email_id %}
                <div class="info-row">
                    <div class="info-label">Email</div>
                    <div class="info-value">{{ doc.email_id }}</div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Right: CONTRACT PERIOD -->
        <div class="right-column">
            <div class="section-header">CONTRACT PERIOD</div>
            <div class="section-content">
                <div class="info-row">
                    <div class="info-label">Start Date</div>
                    <div class="info-value">{{ frappe.utils.formatdate(doc.start_date, "dd-MMM-yy") if doc.start_date else "" }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">End Date</div>
                    <div class="info-value">{{ frappe.utils.formatdate(doc.end_date, "dd-MMM-yy") if doc.end_date else "" }}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Duration</div>
                    <div class="info-value">{{ doc.lease_duration_months or 0 }} Months</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Monthly Payment</div>
                    <div class="info-value">AED {{ "{:,.2f}".format(doc.monthly_payment or 0) }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ownership Progress -->
    {% set progress = ((doc.amount_paid or 0) / (doc.total_amount or 1)) * 100 if doc.total_amount else 0 %}
    <div class="progress-section">
        <div class="section-header">Ownership Journey Progress</div>
        <div class="section-content">
            <div class="progress-bar-container">
                <div class="progress-bar-fill" style="width: {{ progress }}%;">
                    {{ "%.1f"|format(progress) }}%
                </div>
            </div>
            <div class="progress-stats">
                <div class="progress-stat">
                    <div>Amount Paid</div>
                    <div class="progress-stat-value">AED {{ "{:,.0f}".format(doc.amount_paid or 0) }}</div>
                </div>
                <div class="progress-stat">
                    <div>Payments Remaining</div>
                    <div class="progress-stat-value">{{ doc.payments_remaining or 0 }}</div>
                </div>
                <div class="progress-stat">
                    <div>Outstanding Balance</div>
                    <div class="progress-stat-value">AED {{ "{:,.0f}".format(doc.outstanding_amount or 0) }}</div>
                </div>
            </div>
            {% if doc.transfer_status %}
            <div style="text-align: center; margin-top: 10px; padding: 8px; background: white; border: 1px solid #000; font-weight: bold; font-size: 11px;">
                Transfer Status: {{ doc.transfer_status.upper() }}
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Two Column Layout: CONTRACT DETAILS and PAYMENT TERMS -->
    <div class="two-column-container">
        <!-- Left: CONTRACT DETAILS -->
        <div class="left-column">
            <div class="section-header">Contract Details</div>
            <div class="section-content">
                <div class="info-row">
                    <div class="info-label">Contract Status:</div>
                    <div class="info-value">{{ doc.contract_status or "Draft" }}</div>
                </div>
                {% if doc.down_payment %}
                <div class="info-row">
                    <div class="info-label">Down Payment:</div>
                    <div class="info-value">AED {{ "{:,.2f}".format(doc.down_payment) }}</div>
                </div>
                {% endif %}
                {% if doc.vehicle_estimated_value %}
                <div class="info-row">
                    <div class="info-label">Vehicle Estimated Value:</div>
                    <div class="info-value">AED {{ "{:,.2f}".format(doc.vehicle_estimated_value) }}</div>
                </div>
                {% endif %}
                {% if doc.ownership_transfer_price %}
                <div class="info-row">
                    <div class="info-label">Ownership Transfer Price:</div>
                    <div class="info-value">AED {{ "{:,.2f}".format(doc.ownership_transfer_price) }}</div>
                </div>
                {% endif %}
                {% if doc.buyout_option_date %}
                <div class="info-row">
                    <div class="info-label">Buyout Option Date:</div>
                    <div class="info-value">{{ frappe.utils.formatdate(doc.buyout_option_date, "dd-MMM-yy") }}</div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Right: PAYMENT TERMS -->
        <div class="right-column">
            <div class="section-header">PAYMENT TERMS</div>
            <div class="section-content">
                <table class="financial-table">
                    <tbody>
                        {% if doc.down_payment %}
                        <tr>
                            <td>Down Payment</td>
                            <td></td>
                            <td class="amount-col">{{ "{:,.2f}".format(doc.down_payment) }}</td>
                        </tr>
                        {% endif %}
                        <tr>
                            <td>Monthly Installment</td>
                            <td>{{ doc.lease_duration_months or 0 }} x {{ "{:,.2f}".format(doc.monthly_payment or 0) }} /Month</td>
                            <td class="amount-col">{{ "{:,.2f}".format((doc.monthly_payment or 0) * (doc.lease_duration_months or 0)) }}</td>
                        </tr>
                        {% if doc.ownership_transfer_price %}
                        <tr>
                            <td>Final Transfer Payment</td>
                            <td></td>
                            <td class="amount-col">{{ "{:,.2f}".format(doc.ownership_transfer_price) }}</td>
                        </tr>
                        {% endif %}
                        <tr class="total-row">
                            <td colspan="2">Total:</td>
                            <td class="amount-col">AED {{ "{:,.2f}".format(doc.total_amount or 0) }}</td>
                        </tr>
                        <tr style="background: #e8f5e9;">
                            <td colspan="2">Paid to Date</td>
                            <td class="amount-col">AED {{ "{:,.2f}".format(doc.amount_paid or 0) }}</td>
                        </tr>
                        <tr style="background: #fff3cd;">
                            <td colspan="2" style="font-weight: bold;">Outstanding</td>
                            <td class="amount-col" style="font-weight: bold;">AED {{ "{:,.2f}".format(doc.outstanding_amount or 0) }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Notice Section -->
    <div class="notice-section">
        <p><strong>Notice:</strong> This is a Lease to Own agreement. The buyer will have exclusive possession and use of the vehicle throughout the contract period, subject to making all payments as scheduled.</p>

        <p>Upon successful completion of all payment obligations, ownership of the vehicle will be transferred to the buyer. The buyer shall be responsible for all transfer fees, registration costs, and any applicable government charges associated with the ownership transfer.</p>

        <p>The buyer is required to maintain comprehensive insurance coverage on the vehicle throughout the entire contract period and provide proof of insurance upon request.</p>

        <p>Failure to make payments for more than 30 consecutive days may result in repossession of the vehicle and forfeiture of all payments made. The buyer will also be liable for any repossession costs and outstanding amounts.</p>

        <p>The buyer may choose to pay off the remaining balance before the contract end date without penalty. Early settlement does not entitle the buyer to any reduction in the total amount payable.</p>

        <p>This is a legal and binding contract between the Seller and the Buyer; who agree to the standard Terms and Conditions printed on the following page of this contract.</p>
    </div>

    <!-- Signature Section -->
    <div class="signature-section">
        <div class="signature-box">
            <div class="signature-line"></div>
            <div class="signature-title">BUYER OR<br>AUTHORIZED AGENT</div>
        </div>
        <div class="signature-box">
            <div class="signature-line"></div>
            <div class="signature-title">SELLER OR<br>AUTHORIZED AGENT</div>
        </div>
    </div>

    <!-- TERMS & CONDITIONS - NEW PAGE -->
    <div class="page-break">
        <div class="terms-page">
            <div class="terms-title">Terms and Conditions - Lease to Own</div>

            {% if doc.custom_terms %}
            <div class="terms-content">
                {{ doc.custom_terms }}
            </div>
            {% else %}
            <div class="terms-content">
                <ol>
                    <li><strong>Nature of Agreement:</strong> This is a Lease to Own agreement whereby the Buyer agrees to lease the vehicle with the option and intention to acquire full ownership upon completion of all payment obligations as specified herein. During the lease period, the Seller retains legal ownership of the vehicle.</li>

                    <li><strong>Payment Obligations:</strong> The Buyer agrees to make timely monthly payments on or before the designated payment day of each month. All payments must be made in full and on time. Late payments may incur additional fees, penalties, and may affect eligibility for ownership transfer.</li>

                    <li><strong>Down Payment:</strong> If a down payment is specified in this agreement, it must be paid in full before the Buyer takes possession of the vehicle. The down payment is non-refundable in case of default or early termination by the Buyer.</li>

                    <li><strong>Vehicle Possession and Use:</strong> The Buyer shall have exclusive possession and use of the vehicle throughout the contract period, subject to maintaining all payment obligations and complying with all terms of this agreement. The vehicle must be used in a careful, lawful manner and in compliance with all traffic laws and regulations.</li>

                    <li><strong>Insurance Requirements:</strong> The Buyer is fully responsible for maintaining comprehensive insurance coverage on the vehicle during the entire contract period. The insurance policy must name the Seller as a loss payee. Proof of insurance must be provided to the Seller before vehicle handover and upon renewal. Failure to maintain insurance may result in immediate termination of this agreement.</li>

                    <li><strong>Maintenance and Repairs:</strong> The Buyer is responsible for performing regular maintenance and servicing of the vehicle according to the manufacturer's recommended schedule. All maintenance records must be kept and provided to the Seller upon request. The Buyer must not make any unauthorized modifications or alterations to the vehicle.</li>

                    <li><strong>Default and Consequences:</strong> Failure to make payments for more than 30 consecutive days will constitute a default. In case of default, the Seller reserves the right to repossess the vehicle immediately. Upon repossession, all payments made by the Buyer will be forfeited, and the Buyer will remain liable for any outstanding amounts, repossession costs, and damages to the vehicle.</li>

                    <li><strong>Ownership Transfer Process:</strong> Upon successful completion of all payment obligations as specified in this contract, the Seller will initiate the ownership transfer process. The Buyer shall be responsible for all transfer fees, registration costs, documentation charges, and any applicable government taxes or fees associated with the ownership transfer.</li>

                    <li><strong>Transfer Eligibility:</strong> The Buyer becomes eligible for ownership transfer only after: (a) all scheduled payments have been made in full; (b) all traffic fines, penalties, and violations have been settled; (c) the vehicle has been inspected and found to be in acceptable condition; (d) all transfer fees have been paid; and (e) valid insurance coverage is in place.</li>

                    <li><strong>Final Transfer Payment:</strong> If a final transfer payment or buyout price is specified in this agreement, it must be paid in full before ownership can be transferred to the Buyer. This amount is in addition to all regular monthly payments.</li>

                    <li><strong>Early Settlement Option:</strong> The Buyer may choose to pay off the entire remaining balance before the contract end date without incurring any early settlement penalties. However, early settlement does not entitle the Buyer to any discount or reduction in the total amount payable as specified in this agreement.</li>

                    <li><strong>Vehicle Condition and Return:</strong> The Buyer agrees to maintain the vehicle in good condition throughout the contract period. In case of default or early termination, the vehicle must be returned in good condition, normal wear and tear excepted. The Buyer will be charged for any damages, excessive wear, or required repairs.</li>

                    <li><strong>Traffic Violations and Fines:</strong> All traffic fines, violations, penalties, and associated administrative fees incurred during the contract period are the sole responsibility of the Buyer and must be settled promptly. Outstanding fines may delay or prevent ownership transfer.</li>

                    <li><strong>Assignment and Sub-leasing:</strong> This contract is personal to the Buyer and may not be assigned, transferred, or sublet to any third party without the express written consent of the Seller. Any unauthorized transfer will constitute a material breach of this agreement.</li>

                    <li><strong>Termination by Seller:</strong> The Seller reserves the right to terminate this agreement immediately and repossess the vehicle if: (a) the Buyer fails to make payments as agreed; (b) the Buyer breaches any term of this agreement; (c) the vehicle is abandoned or misused; (d) the Buyer fails to maintain required insurance; or (e) the vehicle is used for illegal purposes.</li>

                    <li><strong>Dispute Resolution:</strong> Any disputes arising from this Lease to Own agreement shall first be attempted to be resolved through good faith negotiations between the parties. If resolution cannot be achieved within 30 days, the matter may be submitted to arbitration or legal proceedings.</li>

                    <li><strong>Governing Law and Jurisdiction:</strong> This Lease to Own agreement is governed by and shall be construed in accordance with the laws of the United Arab Emirates. Both parties agree to submit to the exclusive jurisdiction of the courts of Dubai, UAE for any legal proceedings arising from this contract.</li>

                    <li><strong>Entire Agreement and Amendments:</strong> This document constitutes the entire Lease to Own agreement between the Seller and Buyer and supersedes all prior agreements, understandings, negotiations, or representations. Any amendments, modifications, or waivers of any terms must be made in writing and signed by both parties to be valid and enforceable.</li>

                    <li><strong>Acknowledgment of Understanding:</strong> By signing this agreement, the Buyer acknowledges that they have read, understood, and agree to all terms and conditions. The Buyer confirms that they have had the opportunity to seek independent legal advice before entering into this agreement.</li>
                </ol>
            </div>
            {% endif %}

            <!-- Signature Section on Terms Page -->
            <div class="signature-section">
                <div class="signature-box">
                    <div class="signature-line"></div>
                    <div class="signature-title">BUYER OR<br>AUTHORIZED AGENT</div>
                </div>
                <div class="signature-box">
                    <div class="signature-line"></div>
                    <div class="signature-title">SELLER OR<br>AUTHORIZED AGENT</div>
                </div>
            </div>
        </div>
    </div>
</div>
