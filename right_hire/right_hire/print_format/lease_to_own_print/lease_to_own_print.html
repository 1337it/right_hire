<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    .print-format {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
        color: #1a1a1a;
        line-height: 1.6;
        max-width: 210mm;
        margin: 0 auto;
        background: white;
    }

    /* Header Section */
    .document-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 40px 0 30px;
        border-bottom: 1px solid #e0e0e0;
        margin-bottom: 40px;
    }

    .logo-section {
        flex: 1;
    }

    .company-logo {
        width: 180px;
        height: 60px;
        background: linear-gradient(135deg, #1a1a1a 0%, #4a4a4a 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
        color: white;
        font-weight: 700;
        font-size: 24px;
        letter-spacing: 1px;
    }

    .header-info {
        text-align: right;
        flex: 1;
    }

    .document-type {
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 2px;
        color: #666;
        font-weight: 600;
        margin-bottom: 8px;
    }

    .document-number {
        font-size: 24px;
        font-weight: 700;
        color: #1a1a1a;
        margin-bottom: 12px;
    }

    .document-date {
        font-size: 13px;
        color: #666;
    }

    .status-indicator {
        display: inline-block;
        padding: 6px 16px;
        border-radius: 20px;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-top: 12px;
    }

    .status-draft { background-color: #f5f5f5; color: #666; }
    .status-active { background-color: #e8f5e9; color: #2e7d32; }
    .status-completed { background-color: #e3f2fd; color: #1565c0; }
    .status-defaulted { background-color: #ffebee; color: #c62828; }
    .status-cancelled { background-color: #fce4ec; color: #ad1457; }
    .status-ownership-transferred { background-color: #fff9c4; color: #f57f17; }

    /* Section Styles */
    .content-section {
        margin-bottom: 35px;
    }

    .section-header {
        font-size: 12px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1.5px;
        color: #1a1a1a;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 2px solid #1a1a1a;
    }

    .info-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 25px 40px;
    }

    .info-field {
        display: flex;
        flex-direction: column;
    }

    .field-label {
        font-size: 10px;
        text-transform: uppercase;
        letter-spacing: 0.8px;
        color: #888;
        font-weight: 600;
        margin-bottom: 6px;
    }

    .field-value {
        font-size: 14px;
        color: #1a1a1a;
        font-weight: 500;
    }

    /* Ownership Journey */
    .ownership-journey {
        background: linear-gradient(135deg, #1a1a1a 0%, #4a4a4a 100%);
        color: white;
        padding: 30px;
        border-radius: 4px;
        margin: 30px 0;
    }

    .journey-title {
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 1.5px;
        font-weight: 700;
        margin-bottom: 25px;
        text-align: center;
    }

    .progress-container {
        background: rgba(255,255,255,0.1);
        border-radius: 20px;
        height: 40px;
        overflow: hidden;
        margin: 20px 0;
        position: relative;
    }

    .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #c9aa71 0%, #f4e4c1 50%, #c9aa71 100%);
        transition: width 0.5s ease;
        display: flex;
        align-items: center;
        justify-content: flex-end;
        padding-right: 15px;
        font-weight: 700;
        font-size: 13px;
        color: #1a1a1a;
    }

    .journey-stats {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin-top: 25px;
    }

    .journey-stat {
        text-align: center;
    }

    .stat-label {
        font-size: 10px;
        text-transform: uppercase;
        letter-spacing: 0.8px;
        color: rgba(255,255,255,0.7);
        margin-bottom: 8px;
    }

    .stat-value {
        font-size: 20px;
        font-weight: 700;
        color: #f4e4c1;
    }

    /* Transfer Status Badge */
    .transfer-badge {
        display: inline-block;
        padding: 12px 24px;
        border-radius: 4px;
        font-weight: 600;
        text-align: center;
        margin: 20px 0;
    }

    .transfer-pending {
        background: #fff3cd;
        border: 2px solid #ffc107;
        color: #856404;
    }

    .transfer-eligible {
        background: #d4edda;
        border: 2px solid #28a745;
        color: #155724;
    }

    .transfer-completed {
        background: #cfe2ff;
        border: 2px solid #0d6efd;
        color: #084298;
    }

    /* Financial Table */
    .financial-summary {
        background: #fafafa;
        border: 1px solid #e0e0e0;
        border-radius: 4px;
        overflow: hidden;
        margin-top: 20px;
    }

    .financial-table {
        width: 100%;
        border-collapse: collapse;
    }

    .financial-table thead {
        background: #1a1a1a;
        color: white;
    }

    .financial-table th {
        padding: 14px 20px;
        text-align: left;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.8px;
    }

    .financial-table td {
        padding: 14px 20px;
        border-bottom: 1px solid #e0e0e0;
        font-size: 13px;
    }

    .financial-table tr:last-child td {
        border-bottom: none;
    }

    .financial-table .amount-col {
        text-align: right;
        font-weight: 600;
        font-variant-numeric: tabular-nums;
    }

    .total-row {
        background: #f5f5f5;
        font-weight: 700;
        font-size: 14px;
    }

    .total-row td {
        border-top: 2px solid #1a1a1a;
    }

    .paid-row {
        background: #e8f5e9;
        font-weight: 600;
    }

    .outstanding-row {
        background: #fff3cd;
        font-weight: 700;
        color: #856404;
    }

    /* Signature Section */
    .signature-container {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 60px;
        margin-top: 60px;
        padding-top: 40px;
    }

    .signature-block {
        text-align: center;
    }

    .signature-line {
        border-top: 2px solid #1a1a1a;
        margin-bottom: 12px;
        padding-top: 80px;
    }

    .signature-name {
        font-size: 14px;
        font-weight: 700;
        color: #1a1a1a;
        margin-bottom: 4px;
    }

    .signature-title {
        font-size: 11px;
        color: #666;
        text-transform: uppercase;
        letter-spacing: 0.8px;
    }

    .signature-date {
        font-size: 10px;
        color: #999;
        margin-top: 8px;
    }

    /* Terms & Conditions Page */
    .page-break {
        page-break-before: always;
        margin-top: 0;
        padding-top: 0;
    }

    .terms-header {
        padding: 40px 0 30px;
        border-bottom: 1px solid #e0e0e0;
        margin-bottom: 40px;
        text-align: center;
    }

    .terms-title {
        font-size: 28px;
        font-weight: 700;
        letter-spacing: 1px;
        color: #1a1a1a;
        margin-bottom: 12px;
    }

    .terms-subtitle {
        font-size: 12px;
        color: #666;
        text-transform: uppercase;
        letter-spacing: 1.5px;
    }

    .terms-content {
        background: #fafafa;
        padding: 30px;
        border-left: 4px solid #1a1a1a;
        border-radius: 2px;
    }

    .terms-content ol {
        counter-reset: term-counter;
        list-style: none;
        padding: 0;
    }

    .terms-content ol li {
        counter-increment: term-counter;
        margin-bottom: 18px;
        position: relative;
        padding-left: 40px;
        font-size: 13px;
        line-height: 1.7;
        color: #333;
    }

    .terms-content ol li:before {
        content: counter(term-counter);
        position: absolute;
        left: 0;
        top: 0;
        width: 28px;
        height: 28px;
        background: #1a1a1a;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 12px;
    }

    /* Footer */
    .document-footer {
        margin-top: 50px;
        padding-top: 25px;
        border-top: 1px solid #e0e0e0;
        text-align: center;
        font-size: 10px;
        color: #999;
        line-height: 1.6;
    }

    /* Print Specific */
    @media print {
        .page-break {
            page-break-before: always;
        }
        body {
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
    }

    /* Highlight Box */
    .highlight-card {
        background: linear-gradient(135deg, #c9aa71 0%, #f4e4c1 50%, #c9aa71 100%);
        color: #1a1a1a;
        padding: 25px 30px;
        border-radius: 4px;
        margin: 30px 0;
        border: 1px solid #c9aa71;
    }

    .highlight-card .info-grid {
        gap: 20px 30px;
    }

    .highlight-card .field-label {
        color: #5a4a2a;
        font-size: 10px;
    }

    .highlight-card .field-value {
        color: #1a1a1a;
        font-size: 16px;
        font-weight: 700;
    }
</style>

<div class="print-format">
    <!-- Document Header -->
    <div class="document-header">
        <div class="logo-section">
            <div class="company-logo">
                <!-- Replace with actual logo: <img src="/files/logo.png" style="max-height: 60px;"> -->
                RIGHT HIRE
            </div>
            <div style="margin-top: 8px; font-size: 11px; color: #666;">Lease to Own Program</div>
        </div>
        <div class="header-info">
            <div class="document-type">Lease to Own Contract</div>
            <div class="document-number">{{ doc.name }}</div>
            <div class="document-date">{{ frappe.utils.formatdate(doc.contract_date if doc.contract_date else doc.creation, "dd MMMM yyyy") }}</div>
            <div class="status-indicator status-{{ doc.contract_status.lower().replace(' ', '-') if doc.contract_status else 'draft' }}">
                {{ doc.contract_status or "Draft" }}
            </div>
        </div>
    </div>

    <!-- Key Details Highlight -->
    <div class="highlight-card">
        <div style="text-align: center; margin-bottom: 20px;">
            <div style="font-size: 11px; text-transform: uppercase; letter-spacing: 1.5px; font-weight: 700; color: #5a4a2a;">Your Path to Ownership</div>
        </div>
        <div class="info-grid">
            <div class="info-field">
                <div class="field-label">Contract Duration</div>
                <div class="field-value">{{ doc.lease_duration_months or 0 }} Months</div>
            </div>
            <div class="info-field">
                <div class="field-label">Monthly Payment</div>
                <div class="field-value">AED {{ "{:,.2f}".format(doc.monthly_payment or 0) }}</div>
            </div>
            <div class="info-field">
                <div class="field-label">Total Investment</div>
                <div class="field-value">AED {{ "{:,.2f}".format(doc.total_amount or 0) }}</div>
            </div>
            <div class="info-field">
                <div class="field-label">Vehicle</div>
                <div class="field-value">{{ doc.vehicle }}</div>
            </div>
        </div>
    </div>

    <!-- Ownership Journey Progress -->
    <div class="ownership-journey">
        <div class="journey-title">Ownership Journey Progress</div>

        {% set progress = ((doc.amount_paid or 0) / (doc.total_amount or 1)) * 100 if doc.total_amount else 0 %}
        <div class="progress-container">
            <div class="progress-bar" style="width: {{ progress }}%;">
                {{ "%.1f"|format(progress) }}% Complete
            </div>
        </div>

        <div class="journey-stats">
            <div class="journey-stat">
                <div class="stat-label">Amount Paid</div>
                <div class="stat-value">AED {{ "{:,.0f}".format(doc.amount_paid or 0) }}</div>
            </div>
            <div class="journey-stat">
                <div class="stat-label">Payments Remaining</div>
                <div class="stat-value">{{ doc.payments_remaining or 0 }}</div>
            </div>
            <div class="journey-stat">
                <div class="stat-label">Outstanding Balance</div>
                <div class="stat-value">AED {{ "{:,.0f}".format(doc.outstanding_amount or 0) }}</div>
            </div>
        </div>

        {% if doc.transfer_status %}
        <div style="text-align: center; margin-top: 25px;">
            <div class="transfer-badge transfer-{{ doc.transfer_status.lower().replace(' ', '-') }}">
                {% if doc.transfer_status == "Completed" %}
                    ✓ OWNERSHIP TRANSFERRED
                {% elif doc.transfer_status == "Eligible" %}
                    ✓ ELIGIBLE FOR OWNERSHIP TRANSFER
                {% elif doc.transfer_status == "In Progress" %}
                    ⏳ TRANSFER IN PROGRESS
                {% else %}
                    ⏳ BUILDING TOWARDS OWNERSHIP
                {% endif %}
            </div>
        </div>
        {% endif %}
    </div>

    <!-- Parties Information -->
    <div class="content-section">
        <div class="section-header">Parties to the Agreement</div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
            <div>
                <h4 style="font-size: 11px; text-transform: uppercase; letter-spacing: 1px; color: #c9aa71; margin-bottom: 15px; font-weight: 700;">SELLER (Current Owner)</h4>
                <div class="info-field" style="margin-bottom: 15px;">
                    <div class="field-label">Company Name</div>
                    <div class="field-value">{{ frappe.db.get_default("company") or "Right Hire" }}</div>
                </div>
            </div>
            <div>
                <h4 style="font-size: 11px; text-transform: uppercase; letter-spacing: 1px; color: #c9aa71; margin-bottom: 15px; font-weight: 700;">BUYER (Future Owner)</h4>
                <div class="info-field" style="margin-bottom: 15px;">
                    <div class="field-label">Customer Name</div>
                    <div class="field-value">{{ doc.customer_name or doc.customer }}</div>
                </div>
                {% if doc.contact_number %}
                <div class="info-field" style="margin-bottom: 15px;">
                    <div class="field-label">Contact Number</div>
                    <div class="field-value">{{ doc.contact_number }}</div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Vehicle Information -->
    <div class="content-section">
        <div class="section-header">Vehicle Specification</div>
        <div class="info-grid">
            <div class="info-field">
                <div class="field-label">Vehicle</div>
                <div class="field-value">{{ doc.vehicle }}</div>
            </div>
            {% if doc.vehicle_details %}
            <div class="info-field">
                <div class="field-label">Vehicle Details</div>
                <div class="field-value">{{ doc.vehicle_details }}</div>
            </div>
            {% endif %}
            {% if doc.plate_no %}
            <div class="info-field">
                <div class="field-label">Plate Number</div>
                <div class="field-value">{{ doc.plate_no }}</div>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Contract Terms -->
    <div class="content-section">
        <div class="section-header">Contract Terms</div>
        <div class="info-grid">
            <div class="info-field">
                <div class="field-label">Contract Start Date</div>
                <div class="field-value">{{ frappe.utils.formatdate(doc.start_date, "dd MMMM yyyy") if doc.start_date else "—" }}</div>
            </div>
            <div class="info-field">
                <div class="field-label">Contract End Date</div>
                <div class="field-value">{{ frappe.utils.formatdate(doc.end_date, "dd MMMM yyyy") if doc.end_date else "—" }}</div>
            </div>
            <div class="info-field">
                <div class="field-label">Contract Duration</div>
                <div class="field-value">{{ doc.lease_duration_months or 0 }} Months</div>
            </div>
            <div class="info-field">
                <div class="field-label">Monthly Payment</div>
                <div class="field-value">AED {{ "{:,.2f}".format(doc.monthly_payment or 0) }}</div>
            </div>
        </div>
    </div>

    <!-- Financial Breakdown -->
    <div class="content-section">
        <div class="section-header">Financial Breakdown</div>
        <div class="financial-summary">
            <table class="financial-table">
                <thead>
                    <tr>
                        <th>Description</th>
                        <th style="width: 200px; text-align: right;">Amount (AED)</th>
                    </tr>
                </thead>
                <tbody>
                    {% if doc.down_payment %}
                    <tr>
                        <td>Down Payment</td>
                        <td class="amount-col">{{ "{:,.2f}".format(doc.down_payment) }}</td>
                    </tr>
                    {% endif %}
                    <tr>
                        <td>Monthly Installments ({{ doc.lease_duration_months or 0 }} × AED {{ "{:,.2f}".format(doc.monthly_payment or 0) }})</td>
                        <td class="amount-col">{{ "{:,.2f}".format((doc.monthly_payment or 0) * (doc.lease_duration_months or 0)) }}</td>
                    </tr>
                    <tr class="total-row">
                        <td>TOTAL CONTRACT VALUE</td>
                        <td class="amount-col">{{ "{:,.2f}".format(doc.total_amount or 0) }}</td>
                    </tr>
                    <tr class="paid-row">
                        <td>Amount Paid to Date</td>
                        <td class="amount-col">{{ "{:,.2f}".format(doc.amount_paid or 0) }}</td>
                    </tr>
                    <tr class="outstanding-row">
                        <td><strong>OUTSTANDING BALANCE</strong></td>
                        <td class="amount-col"><strong>{{ "{:,.2f}".format(doc.outstanding_amount or 0) }}</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Ownership Transfer Details -->
    {% if doc.ownership_transfer_price or doc.transfer_status %}
    <div class="content-section">
        <div class="section-header">Ownership Transfer Details</div>
        <div class="info-grid">
            {% if doc.transfer_status %}
            <div class="info-field">
                <div class="field-label">Transfer Status</div>
                <div class="field-value">{{ doc.transfer_status }}</div>
            </div>
            {% endif %}
            {% if doc.ownership_transfer_price %}
            <div class="info-field">
                <div class="field-label">Transfer Price</div>
                <div class="field-value">AED {{ "{:,.2f}".format(doc.ownership_transfer_price) }}</div>
            </div>
            {% endif %}
            {% if doc.vehicle_estimated_value %}
            <div class="info-field">
                <div class="field-label">Estimated Vehicle Value</div>
                <div class="field-value">AED {{ "{:,.2f}".format(doc.vehicle_estimated_value) }}</div>
            </div>
            {% endif %}
            {% if doc.buyout_option_date %}
            <div class="info-field">
                <div class="field-label">Buyout Option Available From</div>
                <div class="field-value">{{ frappe.utils.formatdate(doc.buyout_option_date, "dd MMMM yyyy") }}</div>
            </div>
            {% endif %}
        </div>
        <div style="background: #fffbea; padding: 15px; margin-top: 20px; border-left: 4px solid #c9aa71; border-radius: 2px;">
            <strong style="color: #856404;">Important:</strong> Upon completion of all payments, ownership of the vehicle will be transferred to the buyer. All transfer fees, registration costs, and applicable government charges are the responsibility of the buyer.
        </div>
    </div>
    {% endif %}

    <!-- Signatures -->
    <div class="signature-container">
        <div class="signature-block">
            <div class="signature-line"></div>
            <div class="signature-name">{{ doc.customer_name or doc.customer }}</div>
            <div class="signature-title">Buyer Signature</div>
            <div class="signature-date">Date: _______________</div>
        </div>
        <div class="signature-block">
            <div class="signature-line"></div>
            <div class="signature-name">{{ frappe.db.get_default("company") or "Right Hire" }}</div>
            <div class="signature-title">Seller Representative</div>
            <div class="signature-date">{{ frappe.utils.formatdate(doc.contract_date if doc.contract_date else doc.creation, "dd MMM yyyy") if (doc.contract_date or doc.creation) else "_______________" }}</div>
        </div>
    </div>

    <!-- Footer -->
    <div class="document-footer">
        <p>This document is generated electronically and is valid without a physical signature.</p>
        <p>{{ frappe.db.get_default("company") or "Right Hire" }} • Lease to Own Program • www.righthire.ae</p>
    </div>

    <!-- TERMS & CONDITIONS - NEW PAGE -->
    <div class="page-break">
        <div class="terms-header">
            <div class="company-logo" style="margin: 0 auto 20px; background: linear-gradient(135deg, #1a1a1a 0%, #4a4a4a 100%);">RIGHT HIRE</div>
            <div class="terms-title">TERMS & CONDITIONS</div>
            <div class="terms-subtitle">Lease to Own Contract {{ doc.name }}</div>
        </div>

        <div class="content-section">
            <div class="section-header">Lease to Own Agreement Terms</div>
            {% if doc.custom_terms %}
            <div class="terms-content">
                {{ doc.custom_terms }}
            </div>
            {% else %}
            <div class="terms-content">
                <ol>
                    <li><strong>Payment Obligations:</strong> The buyer agrees to make timely monthly payments on or before the designated payment day of each month. Late payments may incur additional fees and may affect eligibility for ownership transfer.</li>
                    <li><strong>Vehicle Possession:</strong> The buyer shall have exclusive possession and use of the vehicle throughout the contract period, subject to maintaining all payment obligations and complying with all terms of this agreement.</li>
                    <li><strong>Maintenance & Insurance:</strong> The buyer is fully responsible for maintaining comprehensive insurance coverage and performing regular maintenance on the vehicle during the entire contract period. Proof of insurance and maintenance records must be provided upon request.</li>
                    <li><strong>Default and Repossession:</strong> Failure to make payments for more than 30 consecutive days may result in repossession of the vehicle and forfeiture of all payments made. The buyer will also be liable for any repossession costs and outstanding amounts.</li>
                    <li><strong>Ownership Transfer:</strong> Upon successful completion of all payment obligations as specified in this contract, ownership of the vehicle will be transferred to the buyer. The buyer shall be responsible for all transfer fees, registration costs, and any applicable government charges.</li>
                    <li><strong>Early Settlement:</strong> The buyer may choose to pay off the remaining balance before the contract end date without penalty. Early settlement does not entitle the buyer to any reduction in the total amount payable.</li>
                    <li><strong>Vehicle Condition:</strong> The buyer agrees to maintain the vehicle in good condition, perform recommended maintenance, and not make any unauthorized modifications or alterations without prior written consent from the seller.</li>
                    <li><strong>Traffic Violations:</strong> All traffic fines, violations, and penalties incurred during the contract period are the sole responsibility of the buyer and must be settled promptly.</li>
                    <li><strong>Assignment and Transfer:</strong> This contract may not be assigned, transferred, or sublet to any third party without the express written consent of the seller.</li>
                    <li><strong>Governing Law:</strong> This lease to own contract is governed by the laws of the United Arab Emirates. Any disputes arising from this agreement shall be subject to the exclusive jurisdiction of the courts of Dubai.</li>
                </ol>
            </div>
            {% endif %}
        </div>

        <!-- Signatures on Terms Page -->
        <div class="signature-container">
            <div class="signature-block">
                <div class="signature-line"></div>
                <div class="signature-name">{{ doc.customer_name or doc.customer }}</div>
                <div class="signature-title">Buyer Acknowledgment</div>
                <div class="signature-date">Date: _______________</div>
            </div>
            <div class="signature-block">
                <div class="signature-line"></div>
                <div class="signature-name">{{ frappe.db.get_default("company") or "Right Hire" }}</div>
                <div class="signature-title">Seller Representative</div>
                <div class="signature-date">{{ frappe.utils.formatdate(doc.contract_date if doc.contract_date else doc.creation, "dd MMM yyyy") if (doc.contract_date or doc.creation) else "_______________" }}</div>
            </div>
        </div>

        <div class="document-footer">
            <p><strong>Congratulations on your journey to vehicle ownership!</strong></p>
            <p>By signing this agreement, you acknowledge that you have read, understood, and agree to be bound by these terms and conditions.</p>
            <p>For assistance or inquiries, please contact our customer service team.</p>
        </div>
    </div>
</div>
