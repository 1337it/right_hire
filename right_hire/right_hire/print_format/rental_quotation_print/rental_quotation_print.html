<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    .print-format {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        color: #000;
        line-height: 1.4;
        max-width: 210mm;
        margin: 0 auto;
        background: white;
        padding: 15px;
    }

    /* Header Section */
    .gold-header {
        background: white; border: 3px solid #B8860B;
        padding: 15px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
    }

    .header-left {
        color: #000;
        flex: 1;
    }

    .company-name {
        font-size: 14px;
        font-weight: bold;
        margin-bottom: 3px;
        text-transform: uppercase;
    }

    .company-address {
        font-size: 9px;
        line-height: 1.3;
    }

    .header-logo {
        width: 150px;
        height: 90px;
        background: white;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 3px;
        font-weight: bold;
        font-size: 11px;
        color: #000;
    }

    /* Document Title */
    .document-title {
        text-align: center;
        font-size: 20px;
        font-weight: bold;
        margin: 20px 0 15px 0;
    }

    /* Quotation Header Row */
    .quotation-header {
        border: 2px solid #000;
        display: flex;
        margin-bottom: 2px;
    }

    .quotation-header-item {
        padding: 8px 12px;
        flex: 1;
        display: flex;
        justify-content: space-between;
        border-right: 2px solid #000;
        font-size: 11px;
    }

    .quotation-header-item:last-child {
        border-right: none;
    }

    .header-label {
        font-weight: bold;
    }

    /* Two Column Layout */
    .two-column-container {
        display: flex;
        gap: 2px;
        margin-bottom: 2px;
    }

    .left-column {
        flex: 1;
        border: 2px solid #000;
    }

    .right-column {
        flex: 1;
        border: 2px solid #000;
    }

    /* Section Boxes */
    .section-box {
        border: 2px solid #000;
        margin-bottom: 2px;
    }

    .section-header {
        background: white;
        padding: 6px 12px;
        font-weight: bold;
        font-size: 13px;
        text-transform: uppercase;
        border-bottom: 2px solid #000;
    }

    .section-content {
        padding: 10px 12px;
    }

    .info-row {
        display: flex;
        margin-bottom: 6px;
        font-size: 11px;
    }

    .info-label {
        font-weight: bold;
        min-width: 140px;
    }

    .info-value {
        flex: 1;
    }

    /* Pricing Highlight */
    .pricing-highlight {
        border: 2px solid #000;
        background: #f9f9f9;
        padding: 15px;
        text-align: center;
        margin-bottom: 2px;
    }

    .daily-rate {
        font-size: 24px;
        font-weight: bold;
        color: #000;
        margin: 10px 0;
    }

    .rate-label {
        font-size: 11px;
        color: #666;
        text-transform: uppercase;
    }

    /* Financial Table */
    .financial-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 11px;
    }

    .financial-table td {
        padding: 5px 8px;
        text-align: left;
    }

    .financial-table .amount-col {
        text-align: right;
        font-weight: bold;
    }

    .total-row {
        font-weight: bold;
        font-size: 12px;
        border-top: 1px solid #000;
    }

    /* Status Badge */
    .status-box {
        display: inline-block;
        padding: 8px 16px;
        border: 2px solid #000;
        font-weight: bold;
        font-size: 11px;
        text-transform: uppercase;
    }

    /* Notes Section */
    .notes-section {
        margin: 15px 0;
        font-size: 9px;
        line-height: 1.5;
        text-align: justify;
    }

    .notes-section p {
        margin-bottom: 8px;
    }

    /* Footer */
    .quotation-footer {
        margin-top: 30px;
        padding: 10px;
        border-top: 2px solid #000;
        text-align: center;
        font-size: 10px;
    }

    @media print {
        .page-break {
            page-break-before: always;
            break-before: page;
        }
        body {
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
    }
</style>

<div class="print-format">
    <!-- Gold Header -->
    <div class="gold-header">
        <div class="header-left">
            <div class="company-name">{{ frappe.db.get_default("company") or "RIGHT HIRE" }}</div>
            <div class="company-address">
                {% set company_doc = frappe.get_doc("Company", frappe.db.get_default("company")) if frappe.db.get_default("company") else None %}
                {% if company_doc %}
                {{ company_doc.address or "" }}<br>
                {{ company_doc.city or "" }} {{ company_doc.country or "" }}<br>
                Office: {{ company_doc.phone or "+971 4 XXXXXXX" }}
                {% else %}
                Address Line 1<br>
                Dubai, UAE<br>
                Office: +971 4 XXXXXXX
                {% endif %}
            </div>
        </div>
        <div class="header-logo">
            <img src="/files/logo.png" style="max-width: 100%; max-height: 90px;" alt="Company Logo">
        </div>
    </div>

    <!-- Document Title -->
    <div class="document-title">Rental Quotation</div>

    <!-- Quotation Header -->
    <div class="quotation-header">
        <div class="quotation-header-item">
            <span class="header-label">Quotation No:</span>
            <span>{{ doc.name }}</span>
        </div>
        <div class="quotation-header-item">
            <span class="header-label">Date:</span>
            <span>{{ frappe.utils.formatdate(doc.quotation_date, "dd-MMM-yy") if doc.quotation_date else "" }}</span>
        </div>
        <div class="quotation-header-item">
            <span class="header-label">Valid Until:</span>
            <span>{{ frappe.utils.formatdate(doc.valid_until, "dd-MMM-yy") if doc.valid_until else "" }}</span>
        </div>
    </div>

    <!-- Two Column Layout: CUSTOMER and RENTAL DETAILS -->
    <div class="two-column-container">
        <!-- Left: CUSTOMER -->
        <div class="left-column">
            <div class="section-header">Customer Details</div>
            <div class="section-content">
                <div class="info-row">
                    <div class="info-label">Name:</div>
                    <div class="info-value">{{ doc.customer_name or doc.customer }}</div>
                </div>
                {% if doc.customer_mobile %}
                <div class="info-row">
                    <div class="info-label">Mobile No:</div>
                    <div class="info-value">{{ doc.customer_mobile }}</div>
                </div>
                {% endif %}
                {% if doc.customer_email %}
                <div class="info-row">
                    <div class="info-label">Email:</div>
                    <div class="info-value">{{ doc.customer_email }}</div>
                </div>
                {% endif %}
                {% if doc.driver_name %}
                <div class="info-row">
                    <div class="info-label">Primary Driver:</div>
                    <div class="info-value">{{ doc.driver_name }}</div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Right: RENTAL DETAILS -->
        <div class="right-column">
            <div class="section-header">Rental Details</div>
            <div class="section-content">
                {% if doc.pickup_datetime %}
                <div class="info-row">
                    <div class="info-label">Pickup:</div>
                    <div class="info-value">{{ frappe.utils.format_datetime(doc.pickup_datetime, "dd-MMM-yy HH:mm") }}</div>
                </div>
                {% endif %}
                {% if doc.return_datetime %}
                <div class="info-row">
                    <div class="info-label">Return:</div>
                    <div class="info-value">{{ frappe.utils.format_datetime(doc.return_datetime, "dd-MMM-yy HH:mm") }}</div>
                </div>
                {% endif %}
                <div class="info-row">
                    <div class="info-label">Duration:</div>
                    <div class="info-value">{{ doc.rental_days or 0 }} Day{{ "s" if (doc.rental_days or 0) > 1 else "" }}</div>
                </div>
                {% if doc.vehicle_category %}
                <div class="info-row">
                    <div class="info-label">Vehicle Category:</div>
                    <div class="info-value">{{ doc.vehicle_category }}</div>
                </div>
                {% endif %}
                {% if doc.vehicle or doc.vehicle_details %}
                <div class="info-row">
                    <div class="info-label">Vehicle:</div>
                    <div class="info-value">{{ doc.vehicle_details or doc.vehicle }}</div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Daily Rate Highlight -->
    <div class="pricing-highlight">
        <div class="rate-label">Daily Rental Rate</div>
        <div class="daily-rate">AED {{ "{:,.2f}".format(doc.daily_rate or 0) }}</div>
        <div class="rate-label">per day for {{ doc.rental_days or 0 }} days</div>
    </div>

    <!-- Pricing Breakdown -->
    <div class="section-box">
        <div class="section-header">Pricing Summary</div>
        <div class="section-content">
            <table class="financial-table">
                <tbody>
                    <tr>
                        <td>Daily Rental Rate</td>
                        <td>{{ doc.rental_days or 0 }} x {{ "{:,.2f}".format(doc.daily_rate or 0) }} /Day</td>
                        <td class="amount-col">{{ "{:,.2f}".format((doc.daily_rate or 0) * (doc.rental_days or 0)) }}</td>
                    </tr>
                    {% if doc.extras %}
                        {% for extra in doc.extras %}
                        <tr>
                            <td>{{ extra.extra_name }}</td>
                            <td>{{ extra.description or "" }}</td>
                            <td class="amount-col">{{ "{:,.2f}".format(extra.amount or 0) }}</td>
                        </tr>
                        {% endfor %}
                    {% endif %}
                    {% if doc.deposit_amount %}
                    <tr>
                        <td>Security Deposit</td>
                        <td>(Refundable)</td>
                        <td class="amount-col">{{ "{:,.2f}".format(doc.deposit_amount) }}</td>
                    </tr>
                    {% endif %}
                    {% if doc.tax_amount %}
                    <tr>
                        <td>Tax: 5%</td>
                        <td></td>
                        <td class="amount-col">{{ "{:,.2f}".format(doc.tax_amount) }}</td>
                    </tr>
                    {% endif %}
                    <tr class="total-row">
                        <td colspan="2">Total:</td>
                        <td class="amount-col">AED {{ "{:,.2f}".format(doc.total_amount or 0) }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>


    <!-- Notes Section -->
    <div class="notes-section">
        <p><strong>Important Notes:</strong></p>
        <p>• This quotation is valid until {{ frappe.utils.formatdate(doc.valid_until, "dd MMM yyyy") if doc.valid_until else "the date specified above" }}. Prices and availability are subject to change after this date.</p>
        <p>• The security deposit is fully refundable upon satisfactory return of the vehicle with the same fuel level and in good condition, normal wear and tear excepted.</p>
        <p>• The renter must present a valid driving license (UAE or International) and Emirates ID/passport at the time of pickup.</p>
        <p>• Comprehensive insurance is included. The renter is responsible for the insurance deductible in case of any accident or damage.</p>
        <p>• The vehicle must be returned on time. Late returns will incur additional charges at the daily rate plus a late return penalty.</p>
        <p>• Any traffic fines or violations incurred during the rental period are the responsibility of the renter.</p>
        <p>• The vehicle is provided with a specified fuel level and must be returned with the same fuel level to avoid refueling charges.</p>
        <p>• To proceed with this quotation, please contact us to confirm availability and complete the reservation process.</p>
    </div>

    <!-- TERMS & CONDITIONS - NEW PAGE -->
    <div class="page-break">
    <!-- Terms & Conditions -->
    {% if doc.custom_terms or doc.terms_template %}
    <div class="section-box" style="margin-top: 10px;">
        <div class="section-header">Terms & Conditions</div>
        <div class="section-content" style="font-size: 10px; line-height: 1.5;">
            {% if doc.custom_terms %}
                {{ doc.custom_terms }}
            {% elif doc.terms_template %}
                {% set terms = frappe.get_doc("Terms and Conditions Template", doc.terms_template) %}
                {{ terms.content }}
            {% endif %}
        </div>
    </div>
    {% endif %}

    </div>
    <!-- Footer -->
    <div class="quotation-footer">
        <p><strong>Thank you for considering {{ frappe.db.get_default("company") or "RIGHT HIRE" }}</strong></p>
        <p>We look forward to serving you with our professional vehicle rental services.</p>
        <p style="margin-top: 10px;">This is a computer-generated quotation and does not require a signature.</p>
    </div>
</div>
